
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Alarming Trends With Recent Magento Breaches - Yinette's Webshite</title>
  <meta name="author" content="Yinette">

  
  <meta name="description" content="Note: Sparse on technical details due to ongoing investigations, this post is just a commentary As a Systems Administrator, I&rsquo;ve seen many &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yinette.github.io/blog/2015/05/11/alarming-trends-with-recent-magento-breaches">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Yinette's Webshite" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-53377584-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Yinette's Webshite</a></h1>
  
    <h2>A collection of security stuff and all sorts of other random shit.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:yinette.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Alarming Trends With Recent Magento Breaches</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-11T13:14:32+10:00" pubdate data-updated="true">May 11<sup>th</sup>, 2015</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img src="https://yinette.bucket.nchr.io/lodsofemone.png" alt="loads a money" /></p>

<p><em>Note: Sparse on technical details due to ongoing investigations, this post is just a commentary</em></p>

<p>As a Systems Administrator, I&rsquo;ve seen many kinds of web application compromises. From WordPress, to Joomla, to OSCommerce, you name it.</p>

<p>As of recently, a new kind of vulnerability has arisen for the popular Magento ecommerce platform, aptly called &ldquo;Shoplift&rdquo;[1]
This bug has some serious nastyness that allows for some very bad things to happen to an unpatched site, the exploit itself allows:</p>

<ul>
<li>Authentication Bypass</li>
<li>Remote File Inclusion/Remote Code Execution (mostly due to auth bypass)</li>
<li>SQL Query Injection</li>
</ul>


<h2>Differences in the usual compromise</h2>

<p>This Magento exploit poses a rather different kind of threat than the ususal dime-a-dozen wordpress and joomla sites have, Observing some activity, and indeed corelating with other&rsquo;s discoveries, (namely Sucuri)[2] I&rsquo;m noticing something rather different about wild exploitations of shoplift, here&rsquo;s what I can see and my thoughts on it.</p>

<ul>
<li>Rare that webshells and other specific malicious files are being uploaded.</li>
</ul>


<p>While i have seen it in this particular exploit in the wild, it does not appear to be anything more than access persistance that is then sold on to do bad things (like spamming)</p>

<ul>
<li>Attackers are attempting to remain low profile.</li>
</ul>


<p>As with above, noting they&rsquo;re not leaving traces of their presence that particular anti-virus and web application firewalls can mitigate, they are mostly using parts of the site to their advantage, or are installing innocuous plugins to acheive their goal.</p>

<ul>
<li>Changes to core code are very subtle and ususally try to blend in with the other site functions.</li>
</ul>


<p>Backdoor access to administrative functions via very slight changes to code have been observed.</p>

<ul>
<li>The focus appears to be that of Customer information and sensitive financial details.</li>
</ul>


<p>Given the nature of information that a Magento site will see and store, I think it is highly likely this exploit is going to attract the internet&rsquo;s seedy underbelly of Privacy Theft, Credit Card Fraud, and other very malicious and serious offences, and given what I have seen so far, gives me high confidence of this being the case.</p>

<ul>
<li>A very dedicated core group set to work getting access only days after the details of the exploit were disclosed by the discovering party.</li>
</ul>


<p>As in the sucuri blog, these two Russian IPs have been very busy.</p>

<ul>
<li>Even after a site is patched, admin credentials belonging to attackers can still be present in a database.</li>
</ul>


<p>This leads to the next part of this post.</p>

<h2>What you need to do as a Magento site maintainer/developer</h2>

<ul>
<li><p>Even if you have applied a patch, audit your administrator logs, and administrator user accounts!</p></li>
<li><p>If in doubt , it&rsquo;s probably malicious. Engage a company like sucuri to look for malware and malicious modifications to site code, or completely re-install the core site files.</p></li>
<li><p>Observe what your customers are saying. If they report that they are receiving emails perporting to be your business asking for credit card details, you got an issue.</p></li>
</ul>


<p>In conclusion, a major exploit and very wide-spread attacks were only a matter of time for Magento, as with any popular web application. The implications however are extremely serious, and I would be unsurprised to hear of future major credit card breaches similar to the PoS Malware on Target and other US retail/resturant chains, and the major breaches of sites using unpatched Coldfusion installations.[4]</p>

<p>Keep watching your logs.</p>

<h3>References</h3>

<p><sub></p>

<ol>
<li><a href="https://shoplift.byte.nl/">https://shoplift.byte.nl/</a> &ndash; what is shoplift?</li>
<li><a href="https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html">https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html</a> &ndash; Sucuri reporting of exploits in the wild.</li>
<li><a href="http://www.oaic.gov.au/privacy/privacy-resources/privacy-guides/data-breach-notification-a-guide-to-handling-personal-information-security-breaches">http://www.oaic.gov.au/privacy/privacy-resources/privacy-guides/data-breach-notification-a-guide-to-handling-personal-information-security-breaches</a> &ndash; Advice (For Australian companies) on how to handle privacy breaches.</li>
<li><a href="http://krebsonsecurity.com/2014/03/the-long-tail-of-coldfusion-fail/">http://krebsonsecurity.com/2014/03/the-long-tail-of-coldfusion-fail/</a> &ndash; Details into serious breaches of information on ColdFusion sites used for ecommerce.
</sub></li>
</ol>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Yinette</span></span>

      








  


<time datetime="2015-05-11T13:14:32+10:00" pubdate data-updated="true">May 11<sup>th</sup>, 2015</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://yinette.github.io/blog/2015/05/11/alarming-trends-with-recent-magento-breaches/" data-via="yinettesys" data-counturl="http://yinette.github.io/blog/2015/05/11/alarming-trends-with-recent-magento-breaches/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/01/28/ghost-in-the-library/" title="Previous Post: GHOST in the library">&laquo; GHOST in the library</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/11/alarming-trends-with-recent-magento-breaches/">Alarming Trends With Recent Magento Breaches</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/28/ghost-in-the-library/">GHOST in the Library</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/23/using-shodan-to-find-similarities-between-hosts-in-ssh-brute-force-ranges/">Using Shodan to Find Similarities Between Hosts in SSH Brute Force Ranges</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/02/it-all-began-with-a-struts-exploit-attempt/">It All Began With a Struts Exploit Attempt. Part 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/31/i59-a-story-of-spammers/">I59</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/Yinette">@Yinette</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Yinette',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Yinette -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
